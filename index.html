<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–°–∫–∞—á–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
  <style>
    :root{
      --bg:#0f172a;
      --card:#0b1220;
      --primary-start:#2563eb;
      --primary-end:#1d4ed8;
      --muted: rgba(255,255,255,0.8);
      --glass: rgba(255,255,255,0.03);
    }
    html,body{height:100%;margin:0}
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #071029 0%, var(--bg) 100%);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 24px;
      box-sizing: border-box;
    }
    .container {
      width: 100%;
      max-width: 520px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: 16px;
      padding: 28px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
      text-align: center;
    }
    h1 {
      margin: 0 0 8px 0;
      font-size: 22px;
      font-weight: 700;
      letter-spacing: -0.2px;
    }
    #status {
      margin: 0 0 20px 0;
      color: var(--muted);
      font-size: 15px;
    }

    .controls {
      display:flex;
      justify-content:center;
      gap:12px;
      margin-bottom: 12px;
    }

    .button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width:100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-weight: 700;
      font-size: 16px;
      text-decoration: none;
      color: white;
      transition: transform .12s ease, box-shadow .12s ease;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .button:active { transform: translateY(1px) }

    .primary {
      background: linear-gradient(90deg, var(--primary-start), var(--primary-end));
      box-shadow: 0 8px 20px rgba(29,78,216,0.18);
    }
    .secondary {
      background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      color: var(--muted);
      font-weight: 600;
      box-shadow: 0 6px 14px rgba(2,6,23,0.5);
    }

    .buttons {
      display: none;
      flex-direction: column;
      gap: 12px;
      margin-top: 6px;
    }

    .btn-with-icon { padding-left: 18px; padding-right: 18px; text-align: left; }
    .icon {
      width: 22px;
      height: 22px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:18px;
      opacity:0.98;
    }
    .label {
      flex:1;
      text-align:left;
    }
    .sub {
      display:block;
      font-size:12px;
      opacity:0.85;
      margin-top:2px;
      color: rgba(255,255,255,0.85);
      font-weight:600;
    }

    /* Responsive */
    @media (max-width:420px){
      .container{padding:20px}
      .button{font-size:15px;padding:12px 14px}
    }
  </style>
</head>
<body>
  <div class="container" role="main" aria-labelledby="title">
    <h1 id="title">–°–∫–∞—á–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h1>
    <p id="status" aria-live="polite">–û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∞—à–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ‚Ä¶</p>

    <div class="controls">
      <!-- –ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é" ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∏–¥–Ω–∞ -->
      <button id="manualBtn" class="button primary" aria-expanded="false" type="button">
        <span class="icon">‚¨áÔ∏è</span>
        <span class="label">–°–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é</span>
      </button>
    </div>

    <!-- –°–∫—Ä—ã—Ç—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–Ω–æ–ø–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–±–µ—Ä—ë–º href –∏–∑ –Ω–∏—Ö –≤ —Å–∫—Ä–∏–ø—Ç–µ) -->
    <div class="buttons" id="fallback">
      <a id="link-ios" class="button btn-with-icon primary" href="https://apps.apple.com/ru/app/v2raytun/id6476628951">
        <span class="icon">Ô£ø</span>
        <span class="label">–°–∫–∞—á–∞—Ç—å –¥–ª—è iOS
          <span class="sub">App Store</span>
        </span>
      </a>

      <a id="link-android" class="button btn-with-icon primary" href="https://play.google.com/store/apps/details?id=com.v2raytun.android">
        <span class="icon">ü§ñ</span>
        <span class="label">–°–∫–∞—á–∞—Ç—å –¥–ª—è Android
          <span class="sub">Google Play</span>
        </span>
      </a>

      <a id="link-windows" class="button btn-with-icon primary" href="https://storage.v2raytun.com/v2RayTun_Setup.exe">
        <span class="icon">ü™ü</span>
        <span class="label">–°–∫–∞—á–∞—Ç—å –¥–ª—è Windows
          <span class="sub">–£—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π .exe</span>
        </span>
      </a>

      <a id="link-mac" class="button btn-with-icon primary" href="https://apps.apple.com/en/app/v2raytun/id6476628951">
        <span class="icon">üíª</span>
        <span class="label">–°–∫–∞—á–∞—Ç—å –¥–ª—è Mac
          <span class="sub">Mac App Store / dmg</span>
        </span>
      </a>
    </div>
  </div>

  <script>
    (function () {
      const statusEl = document.getElementById('status');
      const fallback = document.getElementById('fallback');
      const manualBtn = document.getElementById('manualBtn');

      // –ß–∏—Ç–∞–µ–º href –∏–∑ —Å—Å—ã–ª–æ–∫ (—á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å)
      const iosHref = document.getElementById('link-ios').href || null;
      const androidHref = document.getElementById('link-android').href || null;
      const windowsHref = document.getElementById('link-windows').href || null;
      const macHref = document.getElementById('link-mac').href || null;

      let redirectTimeout = null;
      let redirectCanceled = false;

      function detectPlatform() {
        const ua = navigator.userAgent || navigator.vendor || window.opera || '';
        // iPadOS detection (iPadOS 13+ reports MacIntel but has touch)
        const isIpadOs = (navigator.platform === 'MacIntel' && navigator.maxTouchPoints && navigator.maxTouchPoints > 1);
        if (/iPad|iPhone|iPod/.test(ua) || isIpadOs) return 'ios';
        if (/Android/.test(ua)) return 'android';
        if (/Windows NT|Win32|Win64/.test(ua)) return 'windows';
        if (/Macintosh|Mac OS X/.test(ua)) return 'mac';
        return 'unknown';
      }

      function getTargetFor(platform) {
        switch(platform) {
          case 'ios': return iosHref;
          case 'android': return androidHref;
          case 'windows': return windowsHref;
          case 'mac': return macHref;
          default: return null;
        }
      }

      function showFallback() {
        fallback.style.display = 'flex';
        statusEl.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:';
        manualBtn.setAttribute('aria-expanded', 'true');
      }

      function cancelRedirect() {
        redirectCanceled = true;
        if (redirectTimeout) {
          clearTimeout(redirectTimeout);
          redirectTimeout = null;
        }
      }

      // –ù–∞–∂–∞—Ç–∏–µ "–°–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é"
      manualBtn.addEventListener('click', function () {
        cancelRedirect();
        showFallback();
        // –°–∫—Ä—ã–≤–∞–µ–º —Å–∞–º—É –∫–Ω–æ–ø–∫—É "–°–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é"
        manualBtn.style.display = 'none';
      });

      // –ó–∞–ø—É—Å–∫ –ª–æ–≥–∏–∫–∏: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç 3 —Å–µ–∫—É–Ω–¥—ã, –ø–æ—Ç–æ–º —Ä–µ–¥–∏—Ä–µ–∫—Ç –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
      (function initRedirectFlow(){
        statusEl.textContent = '–û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∞—à–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ‚Ä¶';
        const platform = detectPlatform();
        const target = getTargetFor(platform);

        // –ñ–¥—ë–º 3 —Å–µ–∫—É–Ω–¥—ã
        redirectTimeout = setTimeout(function () {
          redirectTimeout = null;
          if (redirectCanceled) return;

          if (target) {
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç
            statusEl.textContent = '–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...';
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º replace —á—Ç–æ–±—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –∏—Å—Ç–æ—Ä–∏–∏
            try {
              window.location.replace(target);
            } catch (e) {
              // –í –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ–º —Å–ª—É—á–∞–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏
              showFallback();
            }
          } else {
            // –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–ª–∏ –Ω–µ—Ç —Å—Å—ã–ª–∫–∏ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏
            showFallback();
          }
        }, 3000);
      })();

      // –î–æ–ø: –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å—ë –∂–µ –Ω–∞–∂–º—ë—Ç –æ–¥–Ω—É –∏–∑ —Å—Å—ã–ª–æ–∫ ‚Äî –æ—Ç–º–µ–Ω—è–µ–º —Ç–∞–π–º–µ—Ä –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
      const downloadLinks = fallback.querySelectorAll('a');
      downloadLinks.forEach(a => a.addEventListener('click', () => cancelRedirect()));
    })();
  </script>
</body>
</html>
